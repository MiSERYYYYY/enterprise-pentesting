# Set the directory where files will be created
$targetDirectory = "C:\AppLockerTestFiles"

# Create the directory if it doesn't exist
if (!(Test-Path -Path $targetDirectory)) {
    New-Item -ItemType Directory -Path $targetDirectory | Out-Null
}

# Define the file extensions and content for each type
$fileDefinitions = @(
    @{ Name = "TestExecutable.exe"; Content = "Executable file content" },
    @{ Name = "TestCommand.com"; Content = "COM file content" },
    @{ Name = "Installer.msi"; Content = "MSI file content" },
    @{ Name = "Patch.msp"; Content = "MSP file content" },
    @{ Name = "Transform.mst"; Content = "MST file content" },
    @{ Name = "BatchScript.bat"; Content = "@echo off`nREM Batch file content" },
    @{ Name = "CommandScript.cmd"; Content = "@echo off`nREM CMD file content" },
    @{ Name = "VBScript.vbs"; Content = "' VBScript file content" },
    @{ Name = "JavaScript.js"; Content = "// JavaScript file content" },
    @{ Name = "PowerShellScript.ps1"; Content = "# PowerShell script content" },
    @{ Name = "UWPApp.appx"; Content = "UWP App package content" },
    @{ Name = "ModernApp.msix"; Content = "Modern App package content" },
    @{ Name = "DynamicLinkLibrary.dll"; Content = "DLL file content" }
)

# Generate each file with specified content
foreach ($fileDef in $fileDefinitions) {
    $filePath = Join-Path -Path $targetDirectory -ChildPath $fileDef.Name
    Set-Content -Path $filePath -Value $fileDef.Content
    Write-Output "Created file: $filePath"
}

Write-Output "All test files have been created in $targetDirectory"

Get-AppLockerPolicy -Local | Test-AppLockerPolicy -Path C:\AppLockerTestFiles\* -User Everyone
